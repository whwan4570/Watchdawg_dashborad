services:
  - type: web
    name: seattle-crime-dashboard
    runtime: python
    region: oregon  
    plan: free      
    
    # Build configuration
    buildCommand: pip install --upgrade pip && pip install -r requirements.txt
    startCommand: gunicorn app:server --bind 0.0.0.0:$PORT --workers 2 --threads 4 --timeout 180 --graceful-timeout 30 --keep-alive 5
    
    # Environment variables
    envVars:
      - key: DATABRICKS_WAREHOUSE_ID
        sync: false
      - key: DATABRICKS_HOST
        sync: false
      - key: DATABRICKS_CLIENT_ID
        sync: false
      - key: DATABRICKS_CLIENT_SECRET
        sync: false
      - key: DATABRICKS_CATALOG
        value: main
      - key: DATABRICKS_SCHEMA
        value: default
      - key: DASH_DEBUG
        value: "0"
      - key: PYTHON_VERSION
        value: "3.11.6"
    
    # Health check configuration
    healthCheckPath: /
    
    # Auto deploy on push
    autoDeploy: true
